/**
 * @module       RD Parallax
 * @author       Evgeniy Gusarov
 * @see          https://ua.linkedin.com/pub/evgeniy-gusarov/8a/a40/54a
 * @version      3.6.2
 */
(function(){(function(k,n,e){var t,x,y,v,f,l,w,p,u;l=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);y=/Chrome/.test(navigator.userAgent);p=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)||/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);v=l&&/crios/i.test(navigator.userAgent);w=/iPhone|iPad|iPod/i.test(navigator.userAgent)&&!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);f=-1!==navigator.appVersion.indexOf("MSIE")||
-1<navigator.appVersion.indexOf("Trident/");u=/windows nt 6.2/.test(navigator.userAgent.toLowerCase())||/windows nt 6.3/.test(navigator.userAgent.toLowerCase());x=null!=n.body.classList;(function(){var f,l,k,b,a;l=0;a=["ms","moz","webkit","o"];f=0;for(k=a.length;f<k;f++)b=a[f],e.requestAnimationFrame=e[b+"RequestAnimationFrame"],e.cancelAnimationFrame=e[b+"CancelAnimationFrame"]||e[b+"CancelRequestAnimationFrame"];e.requestAnimationFrame||(e.requestAnimationFrame=function(a,c){var d,b,h;d=(new Date).getTime();
h=Math.max(0,16-(d-l));b=e.setTimeout(function(){a(d+h)},h);l=d+h;return b});if(!e.cancelAnimationFrame)return e.cancelAnimationFrame=function(a){return clearTimeout(a)}});t=function(){function q(b){this.options=k.extend(!0,{},this.Defaults,b);this.scenes=[];this.initialize();this.scrollY=e.scrollY||e.pageYOffset;this.lastScrollY=-1;this.inputFocus=!1}var z,t;z=function(){function b(a,g,c,d,b,h,m){this.amend=p||f||l?60:0;this.element=a;this.aliases=g;this.type=a.getAttribute("data-type")||"html";
"html"===this.type&&(this.holder=this.createHolder());this.direction="normal"===a.getAttribute("data-direction")||null==a.getAttribute("data-direction")?1:-1;this.fade="true"===a.getAttribute("data-fade");this.blur="true"===a.getAttribute("data-blur");this.boundTo=n.querySelector(a.getAttribute("data-bound-to"));"media"===this.type&&(this.url=a.getAttribute("data-url"));this.responsive=this.getResponsiveOptions();this.element.style.position=!f&&!l||l||u&&f?"absolute":"fixed";switch(this.type){case "media":null!=
this.url&&(this.element.style["background-image"]="url("+this.url+")");break;case "html":f&&l&&(this.element.style["z-index"]=1)}this.refresh(c,d,b,h,m)}b.prototype.refresh=function(a,g,c,d,b){this.speed=this.getOption("speed",a)||0;this.offset=this.getOption("offset",a)||0;l||u&&f||(this.element.style.position=b?"fixed":"absolute");f&&"html"===this.type&&(this.element.style.position="absolute");switch(this.type){case "media":if(!f)return this.offsetHeight=this.getMediaHeight(g,d,this.speed,this.direction),
this.element.style.height=this.offsetHeight+"px";break;case "html":this.element.style.width=this.holder.offsetWidth+"px";this.offsetHeight=this.element.offsetHeight;this.holder.style.height=this.offsetHeight+"px";if(!(!f&&!l||y&&l||u&&f))return f?this.element.style.position="static":b&&(this.element.style.left=this.getOffset(this.holder).left+"px",this.element.style.top=this.getOffset(this.holder).top-c+"px"),this.holder.style.position="static";break;case "custom":return this.offsetHeight=this.element.offsetHeight}};
b.prototype.createHolder=function(){var a;a=n.createElement("div");x?a.classList.add("rd-parallax-layer-holder"):a.className="rd-parallax-layer-holder";this.element.parentNode.insertBefore(a,this.element);a.appendChild(this.element);if(!f&&!l||v)a.style.position="relative";return a};b.prototype.getOption=function(a,g){var c,d;for(c in this.responsive)c<=g&&(d=c);return this.responsive[d][a]};b.prototype.getResponsiveOptions=function(){var a,g,c,d,b,h,m,e,f;e={};m=[];g=[];d=this.aliases;for(c in d)a=
d[c],m.push(c),g.push(a);c=d=0;for(b=m.length;d<b;c=++d)for(h=m[c],e[h]={};-1<=(a=c);)!e[h].speed&&(f=this.element.getAttribute("data"+g[a]+"speed"))&&(e[h].speed=this.getSpeed(f)),!e[h].offset&&(f=this.element.getAttribute("data"+g[a]+"offset"))&&(e[h].offset=parseInt(f)),c--;return e};b.prototype.fuse=function(a,g){var c,d,b;c=this.getOffset(this.element).top+this.element.getBoundingClientRect().top;d=a+g/2;c+=this.offsetHeight/2;b=g/6;d+b>c&&d-b<c?this.element.style.opacity=1:(d=d-b<c?1+(d+b-c)/
g/3*10:1-(d-b-c)/g/3*10,this.element.style.opacity=0>d?0:1<d?1:d.toFixed(2))};b.prototype.move=function(a,g,c,d,b,h,e,r,k){f&&"media"===this.type||l||u&&f||(e?(e=!l||"html"===this.type&&k||v?this.speed*this.direction:this.speed*this.direction-1,g=this.offsetHeight,null!=r?h=(d+c-(r+c))/(c-b):"media"!==this.type?d<c||d>h-c?(h=d<c?d/(c-b):(d+c-h)/(c-b),isFinite(h)||(h=0)):h=.5:h=.5,a=v||f?(b-g)/2+(c-b)*h*e+this.offset:l?-(d-a)*e+(b-g)/2+(c-b)*h*(e+1)+this.offset:-(d-a)*e+(b-g)/2+(c-b)*h*e+this.offset,
l&&null!=r&&(this.element.style.top=d-r+"px"),p&&(this.element.style["-webkit-transform"]="translate3d(0,"+a+"px,0)"),this.element.style.transform="translate3d(0,"+a+"px,0)"):(p&&(this.element.style["-webkit-transform"]="translate3d(0,0,0)"),this.element.style.transform="translate3d(0,0,0)"))};b.prototype.getSpeed=function(a){return Math.min(Math.max(parseFloat(a),0),2)};b.prototype.getMediaHeight=function(a,b,c,d){return b+(-1===d?(b+a)*c:0)+(1>=c?Math.abs(a-b)*c:a*c)+2*this.amend};b.prototype.getOffset=
function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageXOffset)}};return b}();t=function(){function b(a,b,c,d){this.amend=p?60:0;this.element=a;this.aliases=b;this.on=!0;this.agent=n.querySelector(a.getAttribute("data-agent"));this.anchor=this.findAnchor();this.canvas=this.createCanvas();this.layers=this.createLayers(c);this.fitTo=this.getFitElement();this.responsive=this.getResponsiveOptions();this.refresh(c,d)}b.prototype.getFitElement=
function(){var a;return null!=(a=this.element.getAttribute("data-fit-to"))?"parent"===a?this.element.parentNode:n.querySelector(a):null};b.prototype.findAnchor=function(){var a;for(a=this.element.parentNode;null!=a&&a!==n;){if(this.isTransformed.call(a))return a;a=a.parentNode}return null};b.prototype.createCanvas=function(){var a;a=n.createElement("div");x?a.classList.add("rd-parallax-inner"):a.className="rd-parallax-inner";for(this.element.appendChild(a);this.element.firstChild!==a;)a.appendChild(this.element.firstChild);
this.element.style.position="relative";this.element.style.overflow="hidden";f||l?(a.style.position="absolute",u&&f||(a.style.clip="rect(0, auto, auto, 0)"),a.style.transform=f?"translate3d(0,0,0)":"none"):a.style.position="fixed";a.style.left=this.offsetLeft+"px";a.style.top=0;p&&(a.style["margin-top"]="-"+this.amend+"px",a.style.padding=this.amend+"px 0",this.element.style["z-index"]=0);return a};b.prototype.getOption=function(a,b){var c,d;for(c in this.responsive)c<=b&&(d=c);return this.responsive[d][a]};
b.prototype.getResponsiveOptions=function(){var a,b,c,d,e,h,m,f,l;f={};m=[];b=[];d=this.aliases;for(c in d)a=d[c],m.push(c),b.push(a);c=d=0;for(e=m.length;d<e;c=++d)for(h=m[c],f[h]={};-1<=(a=c);)f[h].on||null==(l=this.element.getAttribute("data"+b[a]+"on"))||(f[h].on="false"!==l),null==f[h].on&&0===a&&(f[h].on=!0),c--;return f};b.prototype.createLayers=function(a,b){var c,d,e,h,f;d=k(this.element).find(".rd-parallax-layer").get();h=[];c=e=0;for(f=d.length;e<f;c=++e)c=d[c],h.push(new z(c,this.aliases,
a,b,this.offsetTop,this.offsetHeight,this.on));return h};b.prototype.move=function(a){a=null!=this.anchor?this.positionTop:this.offsetTop-a;p&&(this.canvas.style["-webkit-transform"]="translate3d(0,"+a+"px,0)");return this.canvas.style.transform="translate3d(0,"+a+"px,0)"};b.prototype.refresh=function(a,b){var c,d,e,h,f;h=[];this.on=this.getOption("on",a);this.offsetTop=this.getOffset(this.element).top;this.offsetLeft=this.getOffset(this.element).left;this.width=this.element.offsetWidth;this.canvas.style.width=
this.width+"px";null!=this.anchor&&(this.positionTop=this.element.offsetTop);null!=this.agent?(this.agentOffset=this.getOffset(this.agent).top,this.agentHeight=this.agent.offsetHeight):this.agentOffset=this.agentHeight=null;f=this.layers;c=0;for(e=f.length;c<e;c++)d=f[c],"media"===d.type?h.push(d):d.refresh(a,b,this.offsetTop,this.offsetHeight,this.on);this.offsetHeight=this.canvas.offsetHeight-2*this.amend;this.element.style.height=this.offsetHeight+"px";c=0;for(e=h.length;c<e;c++)d=h[c],d.refresh(a,
b,this.offsetTop,this.offsetHeight,this.on)};b.prototype.update=function(a,b,c,d,e){var h,m,r,k,n,p,q;q=this.offsetTop;p=this.offsetHeight;f||l||this.move(a);k=this.layers;n=[];h=0;for(r=k.length;h<r;h++)m=k[h],m.move(a,b,c,q,p,d,this.on,this.agentOffset,e),!m.fade||l||f?n.push(void 0):n.push(m.fuse(q,p));return n};b.prototype.isTransformed=function(){var a,b,c;c={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};
for(a in c)c.hasOwnProperty(a)&&null!=this.style[a]&&(b=e.getComputedStyle(this).getPropertyValue(c[a]));return null!=b&&0<b.length&&"none"!==b?!0:!1};b.prototype.getOffset=function(a){a=a.getBoundingClientRect();return{top:a.top+(e.scrollY||e.pageYOffset),left:a.left+(e.scrollX||e.pageYOffset)}};return b}();q.prototype.Defaults={selector:".rd-parallax",screenAliases:{0:"-",480:"-xs-",768:"-sm-",992:"-md-",1200:"-lg-",1920:"-xl-",2560:"-xxl-"}};q.prototype.initialize=function(){var b,a,g,c,d,f,h;
b=this;g=n.querySelectorAll(b.options.selector);h=e.innerWidth;f=e.innerHeight;a=c=0;for(d=g.length;c<d;a=++c)a=g[a],b.scenes.push(new t(a,b.options.screenAliases,h,f));k(e).on("resize",k.proxy(b.resize,b));k("body").on("resize",k.proxy(b.resize,b));if(w)k("input").on("focusin focus",function(a){a.preventDefault();b.activeOffset=k(this).offset().top;return e.scrollTo(e.scrollX||e.pageXOffset,b.activeOffset-this.offsetHeight-100)});k(e).trigger("resize");b.update()};q.prototype.resize=function(){var b,
a,g,c;if((b=e.innerWidth)!==this.windowWidth||!l){this.windowWidth=b;this.windowHeight=e.innerHeight;this.documentHeight=n.body.offsetHeight;g=this.scenes;b=0;for(a=g.length;b<a;b++)c=g[b],c.refresh(this.windowWidth,this.windowHeight);return this.update(!0)}};q.prototype.update=function(b){var a,g,c,d,f,h,m,k,p,q;g=this;b||requestAnimationFrame(function(){g.update()});k=e.scrollY||e.pageYOffset;w&&null!=(a=n.activeElement)&&(a.tagName.match(/(input)|(select)|(textarea)/i)?(g.activeElement=a,g.inputFocus=
!0):(g.activeElement=null,g.inputFocus=!1,b=!0));l&&y&&(a=e.innerHeight-g.windowHeight,g.deltaHeight=a,k-=g.deltaHeight);if((k!==g.lastScrollY||b)&&!g.isActing){g.isActing=!0;q=g.windowWidth;p=g.windowHeight;c=g.documentHeight;a=k-g.lastScrollY;w&&null!=g.activeElement&&(g.activeElement.value+=" ",g.activeElement.value=g.activeElement.value.trim());h=g.scenes;d=0;for(f=h.length;d<f;d++)m=h[d],(g.inputFocus||b||k+p>=(m.agentOffset||m.offsetTop)+a&&k<=(m.agentOffset||m.offsetTop)+(m.agentHeight||m.offsetHeight)+
a)&&m.update(k,q,p,c,g.inputFocus);g.lastScrollY=k;return g.isActing=!1}};return q}();k.RDParallax=function(e){var f;f=k(n);if(!f.data("RDParallax"))return f.data("RDParallax",new t(e))};return e.RDParallax=t})(window.jQuery,document,window);"undefined"!==typeof module&&null!==module?module.exports=window.RDParallax:"function"===typeof define&&define.amd&&define(["jquery"],function(){return window.RDParallax})}).call(this);
